<!DOCTYPE html>
<html>

	<head>
		<meta charset="UTF-8">
		<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
		<title>密码安全</title>
		<link rel="stylesheet" type="text/css" href="css/public.css" />
		<link rel="stylesheet" type="text/css" href="css/style.css" />
		<link rel="stylesheet" href="css/swiper.min.css" />
		<script type="text/javascript" src="js/jquery1.11.3.min.js"></script>
		<script src="js/public.js"></script>
		<script src="js/swiper.min.js"></script>

	    <!-- All css -->
		<!-- Bootstrap css-->
		<link rel="stylesheet" href="assets/css/bootstrap.min.css">
		<!-- fontawesome css -->
		<link rel="stylesheet" href="assets/fonts/fontawesome/css/all.min.css">
		<!-- flaticon css -->
		<link rel="stylesheet" href="assets/fonts/flaticon/flaticon.css">
		<!-- magnific css-->
		<link rel="stylesheet" href="assets/css/magnific-popup.css">
		<!-- slick css-->
		<link rel="stylesheet" href="assets/css/slick.css">
		<!-- swiper slider css-->
		<link rel="stylesheet" href="assets/css/swiper-bundle.min.css">
		<!-- nice-select css-->
		<link rel="stylesheet" href="assets/css/nice-select.css">
		<!-- jquery.nice-number css-->
		<link rel="stylesheet" href="assets/css/jquery.nice-number.css">
		<!-- jquery-ui css-->
		<link rel="stylesheet" href="assets/css/jquery-ui.min.css">
		<!-- default css-->
		<link rel="stylesheet" href="assets/css/default.css">
		<!-- style css-->
		<link rel="stylesheet" href="assets/css/style.css">
	    <!-- jquery  -->
	    <script src="common/js/jquery-1.10.2.js" id = "js0"></script>

	    <!--modernizr js-->
	    <script src="assets/js/vendor/modernizr-3.6.0.min.js" id = "js1"></script>
	    <!-- Bootstrap js  -->
	    <script src="assets/js/vendor/popper.min.js" id = "js2"></script>
	    <script src="assets/js/vendor/bootstrap.min.js" id = "js3"></script>
	    <!-- Magnific-popup js-->
	    <script src="assets/js/vendor/jquery.magnific-popup.min.js" id = "js4"></script>
	    <!-- Slick js-->
	    <script src="assets/js/vendor/slick.min.js" id = "js5"></script>
	    <!-- swiper slider js-->
	    <script src="assets/js/vendor/swiper-bundle.min.js"  id = "js6"></script>
	    <!-- Isotope js-->
	    <script src="assets/js/vendor/isotope.pkgd.min.js" id = "js7"></script>
	    <!-- Slick js-->
	    <script src="assets/js/vendor/imagesloaded.pkgd.min.js" id = "js8"></script>
	    <!-- nice select js-->
	    <script src="assets/js/vendor/jquery.nice-select.min.js" id = "js9"></script>
	    <!-- select number -->
	    <script src="assets/js/vendor/jquery.nice-number.min.js" id = "js10"></script>
	    <!-- jquery-ui js-->
	    <script src="assets/js/vendor/jquery-ui.min.js" id = "js11"></script>
	    <!-- custom js  -->
	    <script src="assets/js/custom.js" id = "js12"></script>

	    <link rel="Icon" type="images/png" href="images/favicon1.png">

	</head>

	<body>
		<header class="olima_header header_v1">
		      <div class="header_navigation">
		        <div class="container">
		          <div class="nav-container d-flex align-items-center justify-content-between">
		            <div class="nav-menu">
		              <!-- Navbar Close Icon -->
		              <div class="navbar-close">
		                <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
		              </div>
		              <!-- 导航栏按钮 -->
		              <nav class="main-menu">
		                <ul>
		                  <li class="menu-item menu-item-has-children toumin-menu" ><a href="index.html">社区首页</a></li>
		                  <li class="menu-item menu-item-has-children static"><a href="product.html">二手商品</a></li>
		                  <li class="menu-item menu-item-has-children"><a href="shiwuzhaoling.html">失物招领</a></li>
		                  <li class="menu-item menu-item-has-children"><a href="jianzhi.html">兼职信息</a></li>
		                  <li class="menu-item menu-item-has-children"><a href="todolist.html">日程安排</a></li>
		                </ul>
		              </nav>
		              <!-- 搜索框 -->
		              <div class="nav-pushed-item">
		                <div class="header_search">
		                  <form>
		                    <div class="form_group">
		                      <input type="search" class="form_control" placeholder="Hit enter to search" name="search" required>
		                      <i class="fas fa-search"></i>
		                    </div>
		                  </form>
		                </div>
		              </div>              
		            </div>
		            <div class="nav-push-item">
		              <div class="header_search">
		                <form>
		                  <div class="form_group">
		                    <input type="search" class="form_control" placeholder="Hit enter to search" name="search" required>
		                    <i class="fas fa-search"></i>
		                  </div>
		                </form>
		              </div>
		            </div>
		            <div class="main-menu">
		              <ul>
		              <li class="menu-item menu-item-has-children"> <a class="sign" href="register.html">进入社区</a> </li>
		              </ul>
		            </div>
		            <div class="dopebox clearfloat">
		              <div class="dope">
		                <a href="chat.html"><img src="images/dope.png" /> <span>4</span></a>
		              </div>
		              <div class="login_tou">
		                <a href="person.html"><img src="images/login.png" class="touxiang" style="height:28px;width:28px;border-radius: 50% 50%;"/></a>
		                <div class="login_down">
		                  <ul>
		                    <li><img src="images/nolog.png" class="touxiang" style="height:28px;width:28px;border-radius: 50% 50%;"/> <span class="mingcheng">超人2018</span></li>
		                    <li><a href="">个人中心</a></li>
		                    <li><a href="">设置</a></li>
		                    <li class = "quit"><a href="index.html">退出</a></li>
		                  </ul>
		                </div>
		              </div>
		            </div>
		            <!-- Navbar Toggler -->
		            <div class="navbar-toggler">
		              <span></span><span></span><span></span>
		            </div>
		          </div>
		        </div>
		      </div>
		    </header>
		<!--top-->
		<div class="centop">
			<span class="cen_set">
				设置
			</span>
			<a href=""><img src="images/return.png"/><span>返回</span></a>
		</div>
		<!--个人中心返回-->
           <div class="per_cenbox clearfloat">
           	  <div class="per_le">
           	  	 <div class="per_tit">
           	  	 	设置
           	  	 </div>
           	  	 <ul class="clearfloat">
           	  	 	<li class="per_data"><a href="person.html" ><img src="images/data2.png"/><span>个人资料</span></a></li>
           	  	 	<li class="per_data"><a href="password.html" class="active"><img src="images/pas2.png"/><span>密码安全</span></a></li>
           	  	 	<li class="per_data"><a href="tiezi.html" ><img src="images/seo.png"/><span>发帖</span></a></li>
           	  	 </ul>
           	  </div>
           	  <div class="per_seo">
           	  	<div class="pas_tit">
           	  		您必须填写原密码才能修改下面的资料
           	  	</div>
           	  	<div class="pas_safe">
           	  		<ul>
           	  			<li><span class="safe_tit">旧密码</span><input type="password" class="oldPassword"/></li>
           	  			<li><span class="safe_tit">新密码</span><input type="password" class="newPassword"/></li>
           	  			<li><span class="safe_tit">确认新密码</span><input type="password" class="confirmPassword"/></li>
           	  			<li><span class="safe_tit">验证码</span><input type="text" class="indent"/><button class="indent_btn">换一个</button></li>
           	  			<li><span class="safe_tit"></span><p>输入下图中的字符</p>
           	  				<div class="safepic">
           	  					<img src="images/temp/safe.png" class="verifyCode"/>
           	  				</div>
           	  			</li>
           	  		</ul>
           	  	</div>
           	  	
           	  	<a href="javascript:;" class="keeps">保存</a>
           	  </div>
           </div>

		<!--个人中心-->
<!-- 		<div class="footbox">
			<div class="footer clearfloat">
				<div class="analyse">
					<h1>新能源资讯门户网</h1>
					<p><a href="">新能源出行方式</a><span>| </span><a href="">电动汽车</a><span>|</span><a href="">智能车载有趣的和前沿的</a></p>
					<p class="ao">苏ICP备05055654号-1</p>
				</div>
				<div class="footline"></div>
				<div class="about">
					<h1>关于我们</h1>
					<p><a href="">联系我们</a></p>
					<p><a href="">商务合作</a></p>
				</div>
				<div class="serve">
					<h1>服务条款</h1>
					<p><a href="">招聘服务</a></p>
				</div>
				<div class="footline"></div>
				<div class="follow">
					<img src="images/temp/wei.png" />
					<p>关注公众号</p>
				</div>

			</div>
			<p class="w_ao">苏ICP备05055654号-1</p>
		</div> -->
		<!--footer-->
	</body>
	<script>
		function getCookie(c_name)
		{
			if (document.cookie.length>0)
			{
				c_start=document.cookie.indexOf(c_name + "=")
				if (c_start!=-1)
				{
					c_start=c_start + c_name.length+1
					c_end=document.cookie.indexOf(";",c_start)
					if (c_end==-1) c_end=document.cookie.length
					return unescape(document.cookie.substring(c_start,c_end))
				}
			}
			return ""
		}
    	$(function() {
    		$('.indent_btn').click(function() {
    			getImg();
			});
    		$(".keeps").click(function() {
    			var oldPassword = $(".oldPassword").val();
    			var newPassword = $(".newPassword").val();
    			var confirmPassword = $(".confirmPassword").val();
    			var verifyCode = $(".indent").val();
    			if(oldPassword === "" || newPassword === "" || confirmPassword === "" || verifyCode === "") {
    				alert("你还有填写完整信息，请填写完整再试");
				} else if(newPassword !== confirmPassword) {
    				alert("两次输入的密码不相符");
				}else {
    				var formData = new FormData();
					formData.set("oldPassword", oldPassword);
					formData.set("newPassword", newPassword);
					formData.set("username", getCookie("username"));
					formData.set("verifyCode", verifyCode);
					$.ajax({
						url: "http://39.108.117.49/updatePassword",
						type: "POST",
						dataType : "json",
						processData: false,
						contentType: false,
						data:formData,
						success: function(data){
							if(data.message === "true") {
								alert("修改密码成功");
							} else {
								alert("修改密码失败");
							}
							$(".oldPassword").val("");
							$(".newPassword").val("");
							$(".confirmPassword").val("");
							$(".indent").val("");
						},
						error: function() {
							alert("发送出现异常了！！！");
						}
					});
				}
			})
		})
		$('.indent_btn').ready(function () {
			getImg();
		})
		function getImg() {
    		var img = $(".verifyCode");
    		// img.src = "/imgs?date="+new Date().valueOf();
    		img.attr("src", "/imgs?date="+new Date().valueOf())
		}
		function judgeLog() {
			var name = getCookie("username");
			if(name === "" || name === null) {
				alert("您还未登录，请先登录后使用");
				return false;
			} else {
				return true;
			}
		}
    </script>

</html>