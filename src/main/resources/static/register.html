<!DOCTYPE html>
<html>

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
        <title>登录注册</title>
        <link rel="stylesheet" type="text/css" href="css/public.css" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <link rel="stylesheet" href="css/swiper.min.css" />

        <!-- All css -->
        <!-- Bootstrap css-->
        <link rel="stylesheet" href="assets/css/bootstrap.min.css">
        <!-- fontawesome css -->
        <link rel="stylesheet" href="assets/fonts/fontawesome/css/all.min.css">
        <!-- flaticon css -->
        <link rel="stylesheet" href="assets/fonts/flaticon/flaticon.css">
        <!-- magnific css-->
        <link rel="stylesheet" href="assets/css/magnific-popup.css">
        <!-- slick css-->
        <link rel="stylesheet" href="assets/css/slick.css">
        <!-- swiper slider css-->
        <link rel="stylesheet" href="assets/css/swiper-bundle.min.css">
        <!-- nice-select css-->
        <link rel="stylesheet" href="assets/css/nice-select.css">
        <!-- jquery.nice-number css-->
        <link rel="stylesheet" href="assets/css/jquery.nice-number.css">
        <!-- jquery-ui css-->
        <link rel="stylesheet" href="assets/css/jquery-ui.min.css">
        <!-- default css-->
        <link rel="stylesheet" href="assets/css/default.css">
        <!-- style css-->
        <link rel="stylesheet" href="assets/css/style.css">
        <!-- jquery  -->
        <script src="common/js/jquery-1.10.2.js" id = "js0"></script>

        <!--modernizr js-->
        <script src="assets/js/vendor/modernizr-3.6.0.min.js" id = "js1"></script>
        <!-- Bootstrap js  -->
        <script src="assets/js/vendor/popper.min.js" id = "js2"></script>
        <script src="assets/js/vendor/bootstrap.min.js" id = "js3"></script>
        <!-- Magnific-popup js-->
        <script src="assets/js/vendor/jquery.magnific-popup.min.js" id = "js4"></script>
        <!-- Slick js-->
        <script src="assets/js/vendor/slick.min.js" id = "js5"></script>
        <!-- swiper slider js-->
        <script src="assets/js/vendor/swiper-bundle.min.js"  id = "js6"></script>
        <!-- Isotope js-->
        <script src="assets/js/vendor/isotope.pkgd.min.js" id = "js7"></script>
        <!-- Slick js-->
        <script src="assets/js/vendor/imagesloaded.pkgd.min.js" id = "js8"></script>
        <!-- nice select js-->
        <script src="assets/js/vendor/jquery.nice-select.min.js" id = "js9"></script>
        <!-- select number -->
        <script src="assets/js/vendor/jquery.nice-number.min.js" id = "js10"></script>
        <!-- jquery-ui js-->
        <script src="assets/js/vendor/jquery-ui.min.js" id = "js11"></script>
        <!-- custom js  -->
        <script src="assets/js/custom.js" id = "js12"></script> 

        <!-- Custom Stylesheet -->
        <link rel="stylesheet" href="css_index/style.css" />
        <link rel="stylesheet" href="css_index/emoji.css" />

        <link rel="stylesheet" href="css_index/lightbox.css" />

        <link rel="stylesheet" href="css_index/swiper.min.css" />
        <script type="text/javascript" src="js_index/jquery1.11.3.min.js"></script>
        <script src="js_index/public.js"></script>
        <script src="js_index/swiper.min.js"></script>

        <link rel="stylesheet" type="text/css" href="css/public.css" />
        <link rel="stylesheet" type="text/css" href="css/style.css" />
        <link rel="stylesheet" href="css/swiper.min.css" />

        <script type="text/javascript" src="js/jquery1.11.3.min.js"></script>
        <script src="js/public.js"></script>
        <script src="js/swiper.min.js"></script>
        <link rel="Icon" type="images/png" href="images/favicon1.png">
        <link href="css/registLogin/youxiang/bootstrap.min.css" rel="stylesheet">
        <link href="css/registLogin/youxiang/a3common.css" rel="stylesheet">
        <link rel="stylesheet" href="css/registLogin/youxiang/font_43459_lbtux0zjkr6yldi.css">
        <link rel="stylesheet" href="css/registLogin/youxiang/register.css">
    </head>

    <body>
    <!-- 导航栏 -->
    <header class="olima_header header_v1">
      <div class="header_navigation">
        <div class="container">
          <div class="nav-container d-flex align-items-center justify-content-between">
            <div class="nav-menu">
              <!-- Navbar Close Icon -->
              <div class="navbar-close">
                <div class="cross-wrap"><span class="top"></span><span class="bottom"></span></div>
              </div>
              <!-- 导航栏按钮 -->
              <nav class="main-menu">
                <ul>
                  <li class="menu-item menu-item-has-children toumin-menu"><a href="index.html">社区首页</a></li>
                  <li class="menu-item menu-item-has-children static"><a href="product.html">二手商品</a></li>
                  <li class="menu-item menu-item-has-children"><a href="shiwuzhaoling.html">失物招领</a></li>
                  <li class="menu-item menu-item-has-children"><a href="jianzhi.html">兼职信息</a></li>
                  <li class="menu-item menu-item-has-children"><a href="todolist.html">日程安排</a></li>
                </ul>
              </nav>
              <!-- 搜索框 -->
              <div class="nav-pushed-item">
                <div class="header_search">
                  <form>
                    <div class="form_group">
                      <input type="search" class="form_control" placeholder="Hit enter to search" name="search" required>
                      <i class="fas fa-search"></i>
                    </div>
                  </form>
                </div>
              </div>              
            </div>
            <div class="nav-push-item">
              <div class="header_search">
                <form>
                  <div class="form_group">
                    <input type="search" class="form_control" placeholder="Hit enter to search" name="search" required>
                    <i class="fas fa-search"></i>
                  </div>
                </form>
              </div>
            </div>
            <div class="main-menu">
              <ul>
              <li class="menu-item menu-item-has-children havechoose"> <a class="sign" href="register.html">进入社区</a> </li>
              </ul>
            </div>
            <div class="dopebox clearfloat">
              <div class="dope">
                <a href="chat.html"><img src="images/dope.png" /> <span>4</span></a>
              </div>
              <div class="login_tou">
                <a href="person.html"><img src="images/login.png" class="touxiang" style="height:28px;width:28px;border-radius: 50% 50%;"/></a>
                <div class="login_down">
                  <ul>
                    <li><img src="images/nolog.png" class="touxiang" style="height:28px;width:28px;border-radius: 50% 50%;"/> <span class="mingcheng">超人2018</span></li>
                    <li><a href="">个人中心</a></li>
                    <li><a href="">设置</a></li>
                    <li class = "quit"><a href="index.html">退出</a></li>
                  </ul>
                </div>
              </div>
            </div>
            <!-- Navbar Toggler -->
            <div class="navbar-toggler">
              <span></span><span></span><span></span>
            </div>
          </div>
        </div>
      </div>
    </header>
<!--top-->
<div class="registbox">
<!--    <img src="images/regbg.png" class="regbj"/>-->
    <img src="images/cover.jpg" class="regbj"/>
    <div class="regist">
        <div class="regtit clearfloat">
            <div class="regiscut active"><span>登录</span></div>
            <div class="regiscut"><span>注册</span></div>
        </div>
        <div class="loginbox">
            <!--登录板块-->
            <div class="login active">
                <div class="textbox">
                    <input type="text" placeholder="请输入用户名" id="username"/>
                </div>
                <div class="textbox">
                    <input type="text" placeholder="密码" class="pas" id="txt_password"/>
                    <span class="eye"></span>
                </div>
                <div class="logbtn">
                    <a href="#" id="userLogin">登录</a>
                </div>
                <div class="rempas clearfloat">
                    <div class="rembtn">
                        <span class="kuang"></span><span>记住密码</span>
                    </div>
                    <div class="forpas">
                        <a href="#">忘记密码？</a>
                    </div>
                </div>
            </div>
            <!--注册板块-->
            <div class="login reg ">
                <div class="textbox">
                    <input type="text" placeholder="请输入注册用户名" id="regUsername"/>
                </div>
                <div class="textbox">
                    <input type="text" placeholder="密码" class="pas" id="regPassword"/>
                    <!--							<span class="codebtn">获取验证码</span>-->
                </div>
                <div class="form-item">
                    <div class="input-warp s">
                        <span class="input-icon iconfont icon-youxiangbangding"></span>
                        <input id="email" name="email" placeholder="邮箱" type="text" class="inputs" value=""/>
                        <div id="popup-captcha" style="display: none"></div>
                    </div>
                    <div class="pull-right">
                        <button id="btnSendCode" class="btn lgbtn blue">获取验证码</button>
                    </div>
                    <p id="kaptchaErr" class="errMsg"></p>
                </div>
                <div class="form-item">
                    <div class="input-warp">
                        <span class="input-icon iconfont icon-yanzhengma"></span><input id="kaptcha" name="kaptcha"
                                                                                        placeholder="验证码" type="text"
                                                                                        class="inputs" value=""/>
                    </div>
                    <p id="emailErr" class="errMsg"></p>
                </div>
                <div class="logbtn">
                    <a id="userRegister">注册</a>
                </div>
            </div>
        </div>
    </div>
</div>

<!--footer-->
<footer class="footer2">
    <!-- Start Footer Bottom Area -->
<!--     <div class="footer-area-bottom">
        <div class="container">
            <div class="row">
                <div class="col-xl-6 col-lg-6 col-md-6">
                    <div class="copyright">
                        <p>
                            Copyright © 2021
                            By <a href="http://www.bootstrapmb.com/">tianyufighter</a> All rights reserved
                        </p>
                    </div>
                </div>
                <div class="col-xl-6 col-lg-6 col-md-6">
                    <div class="footer-menu">
                        <ul>
                            <li><a href="about.html">About</a></li>
                            <li><a href="contact.html">Terms & Condition</a></li>
                            <li><a href="contact.html">Privacy</a></li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div> -->
    <!-- End Footer Bottom Area -->
</footer>
</body>
<script type="text/javascript">
    function IsPC() {
        var userAgentInfo = navigator.userAgent;
        var Agents = ["Android", "iPhone",
            "SymbianOS", "Windows Phone",
            "iPad", "iPod"];
        var flag = true;
        for (var v = 0; v < Agents.length; v++) {
            if (userAgentInfo.indexOf(Agents[v]) > 0) {
                flag = false;
                break;
            }
        }
        return flag;
    }
    function getCookie(c_name) {
        if (document.cookie.length > 0) {
            c_start = document.cookie.indexOf(c_name + "=")
            if (c_start != -1) {
                c_start = c_start + c_name.length + 1
                c_end = document.cookie.indexOf(";", c_start)
                if (c_end == -1) c_end = document.cookie.length
                return unescape(document.cookie.substring(c_start, c_end))
            }
        }
        return ""
    }
    $(window).load(function(){
        var username = getCookie("username");
        if(username !== "" && username !== null) {
        $(".regcut").hide();
        if(getCookie("headImage") !== "" && getCookie("headImage") !== null) {
        $(".touxiang").each(function() {
          $(this).attr("src", getCookie("headImage"));
        })
        }
        $(".mingcheng").html(username);
        console.log(getCookie("headImage"));
        console.log("设置成功");
        $(".dopebox").show();
        } else {
        $(".regcut").show();
        $(".dopebox").hide();
        }
    });

    $(function () {
        // 判断是移动端还是pc端，是移动端不显示导航栏，pc端显示
        if(IsPC() === false) {
            console.log("移动端")
            $(".nav").hide();
        } else {
            $(".nav").show();
            console.log("电脑端")
        }
        $("#userLogin").bind("click", function () {
            var thisUsername = $("#username").val();
            var thisPassword = $("#txt_password").val();
            $.ajax({
                url: "http://39.108.117.49//login",
                type: "post",
                dataType: "json",
                sync: false,
                data: {username: thisUsername, password: thisPassword},
                success: function (target) {
                    if (target.message === "true") {
                        <!--通过此方法来让前台主导向后台发出请求-->
                        // window.location.href = "./index.html"
                        document.cookie = "username="+target.data.username+"; path=/";
                        document.cookie = "headImage="+target.data.headImage+"; path=/";
                        window.location.href = "./index.html";
                    } else if(target.message === "false") {
                        alert("账号或密码错误！！");
                        $("#username").val("");
                        $("#txt_password").val("");
                    }
                },
                error: function (res) {
                    alert("返回出错");
                }
            })
        });

        $("#userRegister").bind("click", function () {
            var thisUsername = $("#regUsername").val();
            var thisPassword = $("#regPassword").val();
            var thisVerifyCode = $("#kaptcha").val();
            $.ajax({
                // url: "http://localhost/register",
                url: "http://39.108.117.49//register",
                type: "post",
                dataType: "json",
                sync: false,
                data: {username: thisUsername, password: thisPassword, verifyCode: thisVerifyCode},
                success: function (data) {
                    if (data.message === "true") {
                        <!--通过此方法来让前台主导向后台发出请求-->
                        alert("注册成功");
                        window.location.href = "/register.html"
                    } else {
                        alert("注册失败，您输入的信息有错误！");
                        $("#username").val("");
                        $("#txt_password").val("");
                        $("#kaptcha").val("");
                    }
                },
                error: function (res) {
                    alert("返回出错");
                }
            })
        });
    });

    $("#btnSendCode").bind("click", function () {
        //发送验证码
        var email = $("#email").val();
        if (email === "") {
            return;
        }
        alert("验证码已发送，请及时查看你的邮箱");
        $(".code").toggle();
        //ajax实现后台邮箱的发送
        $.ajax({
            //url路径
            url: "http://39.108.117.49/sendEmail",
            //data请求数据
            data: {"email": email},
            //dataType json
            type: "post",
            //回调函数
            success: function (data) {
                //回调函数 data 返回流
                if (data === "failure") {
                    alert("发送失败");
                } else if (data === "false") {
                    alert("目标邮箱不存在，请检查你的邮箱是否正确");
                }
            }
        });

    })
    function judgeLog() {
        var name = getCookie("username");
        if(name === "" || name === null) {
            alert("您还未登录，请先登录后使用");
            return false;
        } else {
            return true;
        }
    }
</script>
</html>